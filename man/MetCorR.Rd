% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetCorR.R
\name{MetCorR}
\alias{MetCorR}
\title{MetCorR: GAM-based batch/order correction for metabolomics peak table}
\usage{
MetCorR(method = 2, int_data, order, class, batch, qc_label)
}
\arguments{
\item{method}{Integer; 1 or 2. Default 2. 1 - one feature mode, only run order; 2 - two features mode, run order & batch index.}

\item{int_data}{A data.frame of intensities (rows = samples, cols = features).}

\item{order}{Numeric or coercible; injection order per sample (length = nrow(int_data)).}

\item{class}{Character or factor; sample class/labels per sample (length = nrow(int_data)).}

\item{batch}{Numeric or coercible; batch index per sample (length = nrow(int_data)). Required for method 2.}

\item{qc_label}{Pattern used to identify QC rows in class via \code{grep(qc_label, class)}.}
}
\value{
A numeric data.frame of corrected intensities (same dimnames as input).
}
\description{
Corrects intensity matrices using GAM fits on QC samples.
Two modes:
\enumerate{
\item y ~ s(order)
\item y ~ s(order, batch)
}
}
\examples{
\dontrun{
 data(example_intensity, package = "MetCorR")
 data(example_meta, package = "MetCorR")
 out <- MetCorR(
   method   = 2,
   int_data = example_intensity,
   order    = example_meta$order,
   class    = example_meta$class,
   batch    = example_meta$batch,
   qc_label = "QC"
 )
}

}
